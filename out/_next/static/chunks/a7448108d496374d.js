(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99543,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(18566),a=e.i(32071),r=e.i(59752),i=e.i(31809),n=e.i(14013),c=e.i(73375),d=e.i(78583),o=e.i(55436),m=e.i(83086),x=e.i(87857);let u=["Mutual_NDA.txt","MSA_Master_Services.txt","SOW_Statement_of_Work.txt","Contractor_Agreement.txt"],p={"Mutual_NDA.txt":{title:"Mutual NDA",subtitle:"Protect confidential information between two parties.",pill:"Standard",eta:"~5 mins",iconBg:"bg-blue-50 text-blue-600",icon:(0,t.jsx)(d.FileText,{className:"w-5 h-5"})},"MSA_Master_Services.txt":{title:"MSA (Master Services)",subtitle:"Framework agreement for ongoing service relationships.",pill:"Complex",eta:"~15 mins",iconBg:"bg-orange-50 text-orange-600",icon:(0,t.jsx)(d.FileText,{className:"w-5 h-5"})},"SOW_Statement_of_Work.txt":{title:"SOW (Statement of Work)",subtitle:"Define specific project deliverables and timelines.",pill:"Project",eta:"~10 mins",iconBg:"bg-emerald-50 text-emerald-600",icon:(0,t.jsx)(d.FileText,{className:"w-5 h-5"})},"Contractor_Agreement.txt":{title:"Contractor Agreement",subtitle:"Terms for independent contractors and freelancers.",pill:"HR",eta:"~8 mins",iconBg:"bg-violet-50 text-violet-600",icon:(0,t.jsx)(d.FileText,{className:"w-5 h-5"})}},b=()=>{let e=(0,l.useRouter)(),b=(0,l.useSearchParams)(),{user:h}=(0,a.useAuth)(),[f,g]=(0,s.useState)("templates"),[v,j]=(0,s.useState)([]),[w,N]=(0,s.useState)(""),[y,F]=(0,s.useState)(""),[C,k]=(0,s.useState)(!1),[S,A]=(0,s.useState)(!1),[_,B]=(0,s.useState)(null),[$,D]=(0,s.useState)({}),[T,E]=(0,s.useState)(!1),[I,L]=(0,s.useState)(null),[M,R]=(0,s.useState)(!1),[O,G]=(0,s.useState)([]),[P,V]=(0,s.useState)(""),[W,J]=(0,s.useState)([]),[H,U]=(0,s.useState)([]),[q,K]=(0,s.useState)([]),[z,Q]=(0,s.useState)([]),[X,Y]=(0,s.useState)(!1),[Z,ee]=(0,s.useState)(""),[et,es]=(0,s.useState)(""),[el,ea]=(0,s.useState)(!1),[er,ei]=(0,s.useState)(null),[en,ec]=(0,s.useState)(!1),[ed,eo]=(0,s.useState)("select"),[em,ex]=(0,s.useState)(""),[eu,ep]=(0,s.useState)(""),[eb,eh]=(0,s.useState)(""),[ef,eg]=(0,s.useState)(""),[ev,ej]=(0,s.useState)(""),[ew,eN]=(0,s.useState)(""),[ey,eF]=(0,s.useState)(!1),[eC,ek]=(0,s.useState)(!1),[eS,eA]=(0,s.useState)(null),[e_,eB]=(0,s.useState)(null),e$=(0,s.useRef)(null),eD=(0,s.useRef)(null),eT=(0,s.useRef)(""),eE=(0,s.useMemo)(()=>String(h?.user_id||h?.id||h?.email||"anon"),[h]),eI=e=>`clm:aiBuilderDraft:v1:${eE}:${e}`,eL=e=>`clm:templateGeneratorDraft:v1:${eE}:${e}`,eM=e=>{try{localStorage.removeItem(eL(e))}catch{}},eR=e=>{try{let t;localStorage.setItem((t=e.contractId,`clm:contractGenerationContext:v1:${t}`),JSON.stringify(e))}catch{}},eO=e=>{try{let t=localStorage.getItem(eI(e));if(!t)return null;let s=JSON.parse(t);if(!s||"object"!=typeof s)return null;return{template:String(s.template||e),title:String(s.title||""),html:String(s.html||""),text:String(s.text||""),updatedAt:Number(s.updatedAt||0)}}catch{return null}},eG=(e,t)=>{try{localStorage.setItem(eI(e),JSON.stringify(t))}catch{}},eP=e=>{let t=(e||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");return`<p>${t.replace(/\n/g,"<br/>")}</p>`};(0,s.useEffect)(()=>{eq()},[]),(0,s.useEffect)(()=>{let e=b.get("template");e&&F(e)},[b]),(0,s.useEffect)(()=>{"ai"===(b.get("mode")||b.get("builder")||"").toLowerCase()&&g("ai")},[b]),(0,s.useEffect)(()=>{if(!y){L(null),D({}),J([]),U([]),K([]),es(""),ei(null),ec(!1),eo("select"),ex(""),ep(""),eh(""),eg(""),ej(""),eA(null),eB(null);return}(async()=>{try{E(!0);let e=new r.ApiClient,t=await e.getTemplateFileSchema(y);if(!t.success)return void L(null);let s=t.data;L(s);let l=[];for(let e of s.sections||[])for(let t of e.fields||[])t?.key&&l.push(t.key);D(e=>{let t={...e};for(let e of l)void 0===t[e]&&(t[e]="");return t}),R(!0);let a=await e.getClauses({contract_type:s.template_type});if(a.success){let e=a.data,t=Array.isArray(e)?e:Array.isArray(e?.results)?e.results:[];G(t)}else G([]);Y(!0);let i=await e.getConstraintsLibrary({});if(i.success){let e=i.data,t=Array.isArray(e?.results)?e.results:Array.isArray(e)?e:[];Q(t)}else Q([])}finally{E(!1),R(!1),Y(!1)}})()},[y]),(0,s.useEffect)(()=>{if("templates"!==f||!h||!y||0!==Object.keys($||{}).length||0!==(W||[]).length||0!==(H||[]).length||0!==(q||[]).length)return;let e=(e=>{try{let t=localStorage.getItem(eL(e));if(!t)return null;let s=JSON.parse(t);if(!s||"object"!=typeof s)return null;return{template:String(s.template||e),fieldValues:s.fieldValues||{},selectedClauseIds:Array.isArray(s.selectedClauseIds)?s.selectedClauseIds:[],customClauses:Array.isArray(s.customClauses)?s.customClauses:[],constraints:Array.isArray(s.constraints)?s.constraints:[],updatedAt:Number(s.updatedAt||0)}}catch{return null}})(y);if(!e){ei(null),ec(!1);return}D(e.fieldValues||{}),J(e.selectedClauseIds||[]),U(e.customClauses||[]),K(e.constraints||[]),ei(e.updatedAt||null),ec(!0)},[f,h,y]),(0,s.useEffect)(()=>{if("templates"!==f||!h||!y)return;let e=window.setTimeout(()=>{let e={template:y,fieldValues:$||{},selectedClauseIds:W||[],customClauses:H||[],constraints:q||[],updatedAt:Date.now()};try{localStorage.setItem(eL(y),JSON.stringify(e))}catch{}ei(e.updatedAt)},350);return()=>window.clearTimeout(e)},[f,h,y,$,W,H,q]),(0,s.useEffect)(()=>{if("ai"!==f)return;if(!y)return void eB(null);let e=eO(y);eB(e?.updatedAt?e.updatedAt:null)},[f,y,eE]),(0,s.useEffect)(()=>{if("ai"!==f||!y)return;let e=eO(y);if(e&&(e.html||e.text)){eA(null),ex(e.title||String(eQ?.name||y)),eh(e.text||""),eg(e.html||eP(e.text||"")),ej(""),eo("edit"),eB(e.updatedAt||Date.now());return}"ai"!==(b.get("mode")||"").toLowerCase()&&"1"!==(b.get("autostart")||"")||"select"!==ed||eT.current!==y&&(eT.current=y,eV())},[f,y,ed,b,eE]),(0,s.useEffect)(()=>{if("ai"!==f||"edit"!==ed||!y||!ef&&!eb)return;let e=window.setTimeout(()=>{let e={template:y,title:String(em||eQ?.name||y),html:ef,text:eb,updatedAt:Date.now()};eG(y,e),eB(e.updatedAt)},650);return()=>window.clearTimeout(e)},[f,ed,y,em,ef,eb]);let eV=async()=>{if(y)try{let e=eO(y);if(e&&(e.html||e.text)){eA(null),ex(e.title||String(eQ?.name||y)),eh(e.text||""),eg(e.html||eP(e.text||"")),ej(""),eo("edit"),eB(e.updatedAt||Date.now());return}eA(null),eF(!0);let t=new r.ApiClient,s=await t.getTemplateFileContent(y);if(!s.success)return void eA(s.error||"Failed to load template");let l=String(s.data?.content||""),a=String(s.data?.name||"")||String(y||"Template");ex(a),eh(l),eg(eP(l)),ej(""),eo("edit");let i={template:y,title:a,html:eP(l),text:l,updatedAt:Date.now()};eG(y,i),eB(i.updatedAt)}catch(e){eA(e instanceof Error?e.message:"Failed to load template")}finally{eF(!1)}},eW=async()=>{if(eC)return;let e=eu.trim();if(!e)return void eA("Please enter a prompt");let t=eD.current?.getText()??eb;if(!t.trim())return void eA("Template content is empty");e$.current?.abort();let s=new AbortController;e$.current=s;try{eA(null),ek(!0);let l="";ej("");let a=new r.ApiClient;await a.streamTemplateAiGenerate({prompt:e,current_text:t,contract_type:I?.template_type||eQ?.contract_type},{signal:s.signal,onDelta:e=>{l+=e,ej(l)},onDone:()=>{ej(l)},onError:e=>{eA(e||"AI generation failed")}})}catch(e){if(e?.name==="AbortError")return;eA(e instanceof Error?e.message:"AI generation failed")}finally{ek(!1)}},eJ=()=>{e$.current?.abort(),ek(!1)},eH=async()=>{try{if(eA(null),!h)return void eA("Please sign in to create a draft.");A(!0);let t=new r.ApiClient,s=eD.current?.getText()??eb,l=eD.current?.getHTML()??ef,a=(0,x.sanitizeEditorHtml)(l),i=(em||eQ?.name||"Contract").trim(),n=await t.createContractFromContent({title:i,contract_type:I?.template_type||eQ?.contract_type,rendered_text:s,rendered_html:a,metadata:y?{source:"ai_builder",template_filename:y,template:y,form_inputs:$||{},selected_clause_ids:W||[],selected_clauses:W||[],custom_clauses:H||[],constraints:q||[],editor_client_updated_at_ms:Date.now()}:{source:"ai_builder",editor_client_updated_at_ms:Date.now()}});if(!n.success)return void eA(n.error||"Failed to create draft");let c=String(n.data?.id||"");if(!c)return void eA("Draft created but no contract id returned");if(y&&eR({contractId:String(c),template:y,fieldValues:$||{},selectedClauseIds:W||[],customClauses:H||[],constraints:q||[],updatedAt:e_||Date.now(),createdAt:Date.now()}),y){try{localStorage.removeItem(eI(y))}catch{}eB(null)}e.push(`/contracts/editor?id=${encodeURIComponent(c)}`)}catch(e){eA(e instanceof Error?e.message:"Failed to create draft")}finally{A(!1)}},eU=(0,s.useMemo)(()=>{let e=Array.isArray(O)?O:[],t=P.trim().toLowerCase();return t?e.filter(e=>`${e.clause_id} ${e.name} ${e.content}`.toLowerCase().includes(t)):e},[O,P]),eq=async()=>{try{k(!0);let e=new r.ApiClient,t=await e.listTemplateFiles();if(t.success){let e=t.data?.results||[];if(j(e),!b.get("template")&&e.length>0){let t=e.find(e=>u.includes(e.filename));F((t||e[0]).filename)}}else B(t.error||"Failed to load templates"),j([])}catch(e){console.error("Failed to fetch data:",e),B("Failed to load templates")}finally{k(!1)}};(0,s.useEffect)(()=>{if(!y||"templates"!==f||!h)return;let e=window.setTimeout(async()=>{try{ea(!0);let e=new r.ApiClient,t=await e.previewContractFromFile({filename:y,structuredInputs:$,selectedClauses:W,customClauses:H,constraints:q});t.success&&es(t.data?.rendered_text||"")}finally{ea(!1)}},350);return()=>window.clearTimeout(e)},[y,$,W,H,q,f,h]);let eK=(e,t)=>{D(s=>({...s,[e]:t}))},ez=async t=>{if(t.preventDefault(),!y)return void B("Please select a template");let s=y&&(p[y]?.title||eQ?.name)||"Contract",l=$.party_a_name||$.party_b_name||$.company_name||$.client_name||$.disclosing_party_name||$.receiving_party_name||"",a=l?`${s} — ${l}`:s;A(!0),B(null);try{let t=new r.ApiClient,s=await t.generateContractFromFile({filename:y,title:a,selectedClauses:W,customClauses:H,constraints:q,structuredInputs:$});if(!s.success)return void B(s.error||"Failed to create contract");let l=s.data?.contract?.id;l?(eR({contractId:String(l),template:y,fieldValues:$||{},selectedClauseIds:W||[],customClauses:H||[],constraints:q||[],updatedAt:er||Date.now(),createdAt:Date.now()}),eM(y),ec(!1),ei(null),e.push(`/contracts/editor?id=${encodeURIComponent(String(l))}`)):e.push("/contracts")}catch(e){console.error("Failed to create contract:",e),B(e instanceof Error?e.message:"Failed to create contract")}finally{A(!1)}},eQ=v.find(e=>e.filename===y)||null,eX=(0,s.useMemo)(()=>{let e=new Set(u),t=[],s=new Map;for(let e of v)s.set(e.filename,e);for(let e of u){let l=s.get(e);l&&t.push(l)}return[...t,...v.filter(t=>!e.has(t.filename))]},[v]),eY=(0,s.useMemo)(()=>{let e=w.trim().toLowerCase();return e?eX.filter(t=>`${t.filename||""} ${t.name||""} ${t.description||""} ${t.contract_type||""}`.toLowerCase().includes(e)):eX},[eX,w]),eZ=(0,s.useMemo)(()=>{let e=ew.trim().toLowerCase();return e?eX.filter(t=>`${t.filename||""} ${t.name||""} ${t.description||""} ${t.contract_type||""}`.toLowerCase().includes(e)):eX},[eX,ew]),e0=I?.sections||[],e1=!h||!eQ||S||"templates"!==f;return(0,t.jsx)(i.default,{children:(0,t.jsx)("div",{className:"min-h-screen bg-[#F2F0EB]",children:(0,t.jsxs)("div",{className:"max-w-[1280px] mx-auto px-4 md:px-8 py-6 md:py-8",children:[(0,t.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 sm:gap-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-[28px] md:text-[34px] font-semibold text-[#0F141F] leading-tight",children:"Contract Generator"}),(0,t.jsx)("p",{className:"text-sm md:text-base text-[#6B7280] mt-1",children:"Select a template and autofill details to generate contracts instantly."})]})}),(0,t.jsx)("div",{className:"mt-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,t.jsxs)("div",{className:"flex w-full sm:w-auto items-center rounded-full bg-white border border-black/5 p-1 shadow-sm",children:[(0,t.jsx)("button",{type:"button",onClick:()=>g("templates"),className:`flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition text-center ${"templates"===f?"bg-[#0F141F] text-white":"text-[#0F141F]/70 hover:text-[#0F141F]"}`,children:"Template Based"}),(0,t.jsxs)("button",{type:"button",onClick:()=>g("ai"),className:`flex-1 sm:flex-none px-4 py-2 rounded-full text-sm font-medium transition flex items-center justify-center gap-2 ${"ai"===f?"bg-[#0F141F] text-white":"text-[#0F141F]/70 hover:text-[#0F141F]"}`,children:[(0,t.jsx)(m.Sparkles,{className:"w-4 h-4"})," AI Builder"]})]})}),"ai"===f?(0,t.jsx)("div",{className:"mt-8",children:"select"===ed?(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,t.jsxs)("aside",{className:"col-span-12 lg:col-span-3 bg-white rounded-[18px] border border-black/5 shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 pt-6 pb-4 border-b border-black/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-[#0F141F] text-white flex items-center justify-center",children:(0,t.jsx)(m.Sparkles,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-[#0F141F]",children:"AI Builder"}),(0,t.jsx)("div",{className:"text-xs text-[#6B7280]",children:"Pick a template to start"})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-2 bg-[#F6F3ED] rounded-full px-4 py-2",children:[(0,t.jsx)(o.Search,{className:"w-4 h-4 text-black/35"}),(0,t.jsx)("input",{className:"bg-transparent outline-none text-sm w-full",placeholder:"Search templates…",value:ew,onChange:e=>eN(e.target.value)})]}),(0,t.jsx)("div",{className:"mt-3 text-[11px] text-black/45",children:ew.trim()?`Showing ${eZ.length} results`:`Showing ${eZ.length} templates`})]}),(0,t.jsx)("div",{className:"p-4 space-y-3 overflow-y-auto max-h-[45vh] sm:max-h-[55vh] lg:max-h-[calc(100vh-320px)]",children:0===eZ.length?(0,t.jsx)("div",{className:"text-sm text-black/45 p-2",children:"No templates match your search."}):eZ.map(e=>{let s=y===e.filename;return(0,t.jsxs)("button",{type:"button",onClick:()=>F(e.filename),className:`w-full text-left rounded-2xl border p-4 transition ${s?"border-[#FF5C7A] bg-[#FFF1F4]":"border-black/5 bg-[#F6F3ED] hover:border-black/10"}`,children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[#111827] truncate",children:e.name||e.filename}),(0,t.jsx)("div",{className:"text-xs text-black/45 mt-1 line-clamp-2",children:e.description||e.contract_type||""})]},e.filename)})})]}),(0,t.jsxs)("section",{className:"col-span-12 lg:col-span-9 bg-white rounded-[18px] border border-black/5 shadow-sm p-5 sm:p-6 lg:p-8",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-[#0F141F]",children:"Get Started"}),(0,t.jsx)("div",{className:"text-sm text-[#6B7280] mt-1",children:"Open the template in the editor and apply prompts live."})]}),(0,t.jsx)("button",{type:"button",onClick:eV,disabled:!y||ey,className:"h-11 w-full sm:w-auto px-5 rounded-full bg-[#0F141F] text-white text-sm font-semibold disabled:opacity-60",children:ey?"Loading…":e_?"Resume Draft":"Get Started"})]}),e_?(0,t.jsxs)("div",{className:"mt-4 rounded-2xl border border-black/10 bg-[#F6F3ED] px-4 py-3 text-sm text-black/60",children:["Saved draft found — last updated ",new Date(e_).toLocaleString(),"."]}):null,eS?(0,t.jsx)("div",{className:"mt-5 bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl text-sm",children:eS}):null,(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[#0F141F]",children:"Selected Template"}),(0,t.jsxs)("div",{className:"mt-3 rounded-2xl border border-black/5 bg-[#F6F3ED] p-4",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[#111827]",children:eQ?.name||y||"—"}),(0,t.jsx)("div",{className:"text-xs text-black/45 mt-1",children:eQ?.description||"Template preview will open in the editor."})]})]})]})]}):(0,t.jsxs)("div",{className:"bg-[#F2F0EB]",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{eJ(),eo("select")},className:"w-10 h-10 rounded-full bg-white border border-black/10 shadow-sm grid place-items-center text-black/45 hover:text-black","aria-label":"Back",children:(0,t.jsx)(c.ChevronLeft,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-xl md:text-2xl font-bold text-[#111827] truncate",children:em||eQ?.name||"AI Builder"}),(0,t.jsxs)("div",{className:"text-xs text-black/45 mt-1 truncate",children:["Template: ",y||""]})]})]}),(0,t.jsx)("div",{className:"w-full sm:w-auto flex items-center gap-2",children:(0,t.jsx)("button",{type:"button",onClick:eH,disabled:S||eC||!eb.trim()||!h,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-white border border-black/10 text-sm font-semibold text-[#111827] hover:bg-black/5 disabled:opacity-60",children:"Create Draft"})})]}),eS?(0,t.jsx)("div",{className:"mb-6 bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl text-sm",children:eS}):null,(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,t.jsxs)("section",{className:"col-span-12 lg:col-span-8 bg-white rounded-[28px] border border-black/5 shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-5 py-4 border-b border-black/5 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[#111827]",children:"Template Editor"}),(0,t.jsx)("div",{className:"text-xs text-black/45",children:eC?"Generating suggestion…":"Edit content; accept AI suggestions on the right"})]}),(0,t.jsx)("div",{className:"px-4 sm:px-6 py-5 sm:py-6 overflow-visible lg:overflow-y-auto lg:max-h-[calc(100vh-280px)]",children:(0,t.jsx)(n.default,{valueHtml:ef,disabled:eC,onEditorReady:e=>{eD.current=e},onChange:(e,t)=>{eg(e),eh(t)},editorClassName:`min-h-[50vh] sm:min-h-[60vh] rounded-2xl border border-black/10 bg-white px-5 py-4 text-[13px] leading-6 text-slate-900 font-serif outline-none ${eC?"opacity-80":""}`})})]}),(0,t.jsx)("aside",{className:"col-span-12 lg:col-span-4 space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-[28px] border border-black/5 shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 pt-6 pb-4 border-b border-black/5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-[#111827]",children:"AI Suggestions"}),(0,t.jsx)("span",{className:"text-[11px] text-black/45",children:"Streaming"})]}),(0,t.jsx)("p",{className:"text-xs text-black/45 mt-2",children:"Generate a proposed revision, then accept or reject it."})]}),(0,t.jsxs)("div",{className:"p-5",children:[(0,t.jsx)("textarea",{value:eu,onChange:e=>ep(e.target.value),placeholder:"e.g., Add a termination for convenience clause with 30 days notice, and update payment terms to Net 45.",className:"w-full min-h-[140px] rounded-2xl border border-black/10 bg-[#F6F3ED] px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-[#FF5C7A]/25",disabled:eC}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:eW,disabled:eC||!eu.trim(),className:"h-10 w-full sm:w-auto px-4 rounded-full bg-[#0F141F] text-white text-sm font-semibold disabled:opacity-60",children:eC?"Generating…":"Generate Suggestion"}),eC?(0,t.jsx)("button",{type:"button",onClick:eJ,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-white border border-black/10 text-sm font-semibold text-[#111827] hover:bg-black/5",children:"Stop"}):null]}),eS?(0,t.jsx)("div",{className:"mt-3 text-xs text-rose-600",children:eS}):null,(0,t.jsx)("div",{className:"mt-4 text-xs text-black/45",children:"Tip: be specific (sections, numbers, jurisdictions)."}),(0,t.jsxs)("div",{className:"mt-5 rounded-2xl border border-black/10 bg-white overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-black/5 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-[#111827]",children:"Proposed Revision"}),(0,t.jsx)("div",{className:"text-[11px] text-black/45",children:ev.trim()?"Ready":"None yet"})]}),(0,t.jsxs)("div",{className:"p-4",children:[ev.trim()?(0,t.jsx)("div",{className:"text-xs text-slate-800 whitespace-pre-wrap max-h-64 overflow-y-auto",children:ev}):(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Run a prompt to generate suggestions."}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{let e=(ev||"").trim();e&&(eh(e),eg(eP(e)),ej(""))},disabled:!ev.trim()||eC,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-[#FF5C7A] text-white text-sm font-semibold disabled:opacity-60",children:"Accept"}),(0,t.jsx)("button",{type:"button",onClick:()=>{ej("")},disabled:!ev.trim()||eC,className:"h-10 w-full sm:w-auto px-4 rounded-full bg-white border border-black/10 text-sm font-semibold text-[#111827] hover:bg-black/5 disabled:opacity-60",children:"Reject"})]})]})]})]})]})})]})]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,t.jsx)("h2",{className:"text-sm font-semibold text-[#0F141F]",children:"All Templates"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-white border border-black/5 shadow-sm rounded-full px-4 py-2 w-full sm:w-[420px]",children:[(0,t.jsx)(o.Search,{className:"w-4 h-4 text-black/35"}),(0,t.jsx)("input",{value:w,onChange:e=>N(e.target.value),placeholder:"Search templates…",className:"bg-transparent outline-none text-sm w-full text-[#0F141F] placeholder:text-black/35","aria-label":"Search templates"})]})]}),(0,t.jsx)("div",{className:"mt-4",children:C?(0,t.jsx)("div",{className:"text-sm text-[#6B7280] py-6",children:"Loading templates…"}):0===eY.length?(0,t.jsx)("div",{className:"text-sm text-[#6B7280] py-6",children:"No templates match your search."}):(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:eY.map(e=>{let s=y===e.filename,l=p[e.filename]||{title:e.name,subtitle:e.description||"Template",pill:e.contract_type||"Template",eta:"~5 mins",iconBg:"bg-slate-50 text-slate-700",icon:(0,t.jsx)(d.FileText,{className:"w-5 h-5"})},a=h&&e?.created_by_id&&String(e.created_by_id)===String(h?.user_id);return(0,t.jsx)("button",{type:"button",onClick:()=>F(e.filename),className:`text-left bg-white rounded-[18px] border shadow-sm p-5 transition w-full ${s?"border-[#FF5C7A] ring-2 ring-[#FF5C7A]/20":"border-black/5 hover:border-black/10"}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsx)("div",{className:`w-10 h-10 rounded-xl ${l.iconBg} flex items-center justify-center flex-shrink-0`,children:l.icon}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"font-semibold text-[#0F141F] truncate",children:l.title}),(0,t.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center border flex-shrink-0 ${s?"bg-[#FF5C7A] border-[#FF5C7A]":"bg-white border-black/10"}`,children:s?(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white"}):null})]}),(0,t.jsx)("div",{className:"text-sm text-[#6B7280] mt-1 line-clamp-2",children:l.subtitle}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-xs px-2.5 py-1 rounded-full bg-[#F3F4F6] text-[#0F141F]/70",children:l.pill}),a?(0,t.jsx)("span",{className:"text-xs px-2.5 py-1 rounded-full bg-[#F6F3ED] text-[#0F141F]/70 border border-black/5",children:"Mine"}):null,(0,t.jsx)("span",{className:"text-[11px] text-[#6B7280] truncate",children:e.filename})]})]})]})},e.filename)})})})]}),_&&(0,t.jsx)("div",{className:"mt-6 bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl",children:(0,t.jsx)("p",{className:"font-medium",children:_})}),(0,t.jsxs)("form",{onSubmit:ez,className:"mt-6 grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-[18px] border border-black/5 shadow-sm overflow-hidden lg:col-span-5",children:[(0,t.jsxs)("div",{className:"px-5 py-4 border-b border-black/5 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-7 h-7 rounded-full bg-[#FF5C7A] text-white flex items-center justify-center text-xs font-bold",children:"1"}),(0,t.jsx)("div",{className:"font-semibold text-[#0F141F]",children:"Data Entry"})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{D({}),J([]),U([]),K([]),y&&(eM(y),ei(null),ec(!1))},className:"text-xs text-[#FF5C7A] hover:underline",children:"Clear all"})]}),er?(0,t.jsx)("div",{className:"px-5 pt-4",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-black/10 bg-[#F6F3ED] px-4 py-3 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"text-xs text-black/60",children:[en?"Draft restored":"Auto-saved"," — ",new Date(er).toLocaleString()]}),y?(0,t.jsx)("button",{type:"button",onClick:()=>{eM(y),ei(null),ec(!1)},className:"text-xs font-semibold text-[#0F141F] hover:underline",children:"Clear draft"}):null]})}):null,(0,t.jsx)("div",{className:"p-5 space-y-6",children:y?T?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Loading required fields…"}):(0,t.jsxs)(t.Fragment,{children:[(e0.length?e0:[{title:"Data Entry",fields:[]}]).map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-[11px] tracking-wider text-[#9CA3AF] font-semibold uppercase",children:e.title}),(0,t.jsx)("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-4",children:(e.fields||[]).map(e=>(0,t.jsxs)("div",{className:"select"===e.type?"md:col-span-1":"",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-[#374151] mb-2",children:[e.label," ",e.required?(0,t.jsx)("span",{className:"text-[#FF5C7A]",children:"*"}):null]}),"select"===e.type?(0,t.jsxs)("select",{value:$[e.key]||"",onChange:t=>eK(e.key,t.target.value),className:"w-full px-4 py-3 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40",children:[(0,t.jsx)("option",{value:"",children:"Select…"}),(e.options||[]).map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}):(0,t.jsx)("input",{type:e.type,value:$[e.key]||"",onChange:t=>eK(e.key,t.target.value),className:"w-full px-4 py-3 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40",placeholder:e.label})]},e.key))})]},e.title)),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-[11px] tracking-wider text-[#9CA3AF] font-semibold uppercase",children:"Clause & Constraints"}),(0,t.jsxs)("div",{className:"mt-3 space-y-4",children:[(0,t.jsxs)("div",{className:"bg-[#F7F7F7] rounded-2xl p-4 border border-black/5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"font-semibold text-[#111827] text-sm",children:"Clause Library"}),(0,t.jsx)("div",{className:"text-xs text-[#6B7280]",children:"Optional"})]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("input",{value:P,onChange:e=>V(e.target.value),placeholder:"Search clauses…",className:"w-full px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"})}),(0,t.jsx)("div",{className:"mt-3 max-h-44 overflow-y-auto space-y-2 pr-1",children:M?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Loading clauses…"}):0===eU.length?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"No clauses found."}):eU.slice(0,50).map(e=>{let s=W.includes(e.clause_id);return(0,t.jsxs)("label",{className:"flex items-start gap-3 bg-white rounded-xl border border-black/5 p-3 cursor-pointer hover:border-black/10",children:[(0,t.jsx)("input",{type:"checkbox",checked:s,onChange:()=>{var t;return t=e.clause_id,void J(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"mt-1"}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[#111827] truncate",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-[#6B7280]",children:e.clause_id})]})]},`${e.clause_id}-${e.version}`)})})]}),(0,t.jsxs)("div",{className:"bg-[#F7F7F7] rounded-2xl p-4 border border-black/5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"font-semibold text-[#111827] text-sm",children:"Constraints"}),(0,t.jsx)("button",{type:"button",onClick:()=>K(e=>[...e,{name:"",value:""}]),className:"text-xs px-3 py-1.5 rounded-full bg-white border border-black/10 hover:border-black/20",children:"Add"})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-[#6B7280]",children:"Constraint Library"}),(0,t.jsx)("input",{value:Z,onChange:e=>ee(e.target.value),placeholder:"Search constraints…",className:"mt-2 w-full px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,t.jsx)("div",{className:"mt-2 max-h-44 overflow-y-auto space-y-2 pr-1",children:X?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Loading constraints…"}):0===z.length?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"No constraints available."}):z.filter(e=>{let t=Z.trim().toLowerCase();return!t||`${e.label||""} ${e.key||""} ${e.category||""}`.toLowerCase().includes(t)}).slice(0,40).map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>{let t;(t=(e?.label||e?.key||"").trim())&&K(s=>s.some(e=>(e.name||"").trim().toLowerCase()===t.toLowerCase())?s:[...s,{name:t,value:String(e?.default||"")}])},className:"w-full text-left bg-white rounded-xl border border-black/5 p-3 hover:border-black/10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[#111827] truncate",children:e.label}),(0,t.jsx)("div",{className:"text-xs text-[#6B7280]",children:(e.category||"General")+(e.default?` • Default: ${String(e.default)}`:"")})]}),(0,t.jsx)("div",{className:"text-xs font-semibold text-[#FF5C7A]",children:"Add"})]})},e.key))})]}),(0,t.jsx)("div",{className:"mt-3 space-y-3",children:0===q.length?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Add constraints like jurisdiction, data residency, liability caps, etc."}):q.map((e,s)=>(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsx)("input",{value:e.name,onChange:e=>K(t=>t.map((t,l)=>l===s?{...t,name:e.target.value}:t)),placeholder:"Constraint name",className:"w-full px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{value:e.value,onChange:e=>K(t=>t.map((t,l)=>l===s?{...t,value:e.target.value}:t)),placeholder:"Value",className:"flex-1 px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,t.jsx)("button",{type:"button",onClick:()=>K(e=>e.filter((e,t)=>t!==s)),className:"px-3 py-2.5 rounded-xl bg-white border border-black/10 hover:border-black/20 text-[#6B7280]","aria-label":"Remove constraint",children:"✕"})]})]},s))})]}),(0,t.jsxs)("div",{className:"bg-[#F7F7F7] rounded-2xl p-4 border border-black/5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"font-semibold text-[#111827] text-sm",children:"Custom Clauses"}),(0,t.jsx)("button",{type:"button",onClick:()=>U(e=>[...e,{title:"",content:""}]),className:"text-xs px-3 py-1.5 rounded-full bg-white border border-black/10 hover:border-black/20",children:"Add"})]}),(0,t.jsx)("div",{className:"mt-3 space-y-3",children:0===H.length?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Add custom clauses like non-solicit, security, SLA, etc."}):H.map((e,s)=>(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-black/5 p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("input",{value:e.title||"",onChange:e=>U(t=>t.map((t,l)=>l===s?{...t,title:e.target.value}:t)),placeholder:"Clause title",className:"flex-1 px-4 py-2.5 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40"}),(0,t.jsx)("button",{type:"button",onClick:()=>U(e=>e.filter((e,t)=>t!==s)),className:"px-3 py-2.5 rounded-xl bg-white border border-black/10 hover:border-black/20 text-[#6B7280]","aria-label":"Remove custom clause",children:"✕"})]}),(0,t.jsx)("textarea",{value:e.content,onChange:e=>U(t=>t.map((t,l)=>l===s?{...t,content:e.target.value}:t)),placeholder:"Write clause content…",className:"mt-3 w-full px-4 py-3 border border-black/10 rounded-xl bg-white focus:ring-2 focus:ring-[#FF5C7A]/30 focus:border-[#FF5C7A]/40 min-h-[96px]"})]},s))})]})]})]})]}):(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Select a template to begin."})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-[18px] border border-black/5 shadow-sm overflow-hidden lg:col-span-7 lg:sticky lg:top-6 self-start",children:[(0,t.jsx)("div",{className:"px-5 py-4 border-b border-black/5 flex items-center justify-between",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("div",{className:"text-xs text-[#6B7280] font-semibold",children:"Live Preview"})})}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("div",{className:"bg-[#EEF0F3] rounded-[18px] p-2 sm:p-3",children:(0,t.jsx)("div",{className:"bg-white rounded-[14px] shadow-sm border border-black/5 overflow-hidden",children:(0,t.jsx)("div",{className:"p-5 sm:p-6 overflow-visible lg:overflow-y-auto lg:max-h-[calc(100vh-320px)]",children:el?(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Generating preview…"}):y?et?(0,t.jsx)("div",{className:"inline-block min-w-full",children:(0,t.jsx)("pre",{className:"whitespace-pre-wrap text-[13px] leading-relaxed text-[#111827] font-serif",children:et})}):(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Start filling fields to see a preview."}):(0,t.jsx)("div",{className:"text-sm text-[#6B7280]",children:"Select a template to preview."})})})}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsx)("div",{className:"text-sm text-[#6B7280] min-w-0",children:h?I?.template_type?`Type: ${I.template_type}`:null:"Please log in to create contracts."}),(0,t.jsx)("button",{type:"submit",disabled:e1,className:"bg-[#0F141F] text-white w-full sm:w-auto px-7 py-3.5 rounded-full shadow-lg hover:shadow-xl hover:scale-[1.02] transition-all disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap flex-shrink-0",children:S?"Creating…":"Move to editor"})]})]})]})]})]})]})})})};e.s(["default",0,()=>(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-[#F2F0EB] p-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsx)("div",{className:"bg-white rounded-[20px] shadow-sm p-6 text-gray-600",children:"Loading..."})})}),children:(0,t.jsx)(b,{})})])}]);